language: python
python:
  - 2.7

sudo: false
env:
# commenting this out to save time because we know it would fail until python 2.6
# support won't be restored.
#  - TOX_ENV=py26-dj16-cms30
#  - TOX_ENV=py26-dj16-cms31
#  - TOX_ENV=py26-dj17-cms30
#  - TOX_ENV=py26-dj17-cms31
  matrix:
    - TOX_ENV=py27-dj16-cms30
    - TOX_ENV=py27-dj16-cms31
    - TOX_ENV=py27-dj17-cms30
    - TOX_ENV=py27-dj17-cms31
    - TOX_ENV=pep8
  global:
    - secure: TcBj6UvSaVCndwYIBrc6U4/S+4GKAdDS1Z1bn3H84hYCfapa1SoOKqBz0mm7kF6z6T9XXB5kD39Gu63yO9qJnyeESlz3L5gsLRQKTgfOJnwJeN7kKGYnpXjLbV993lmLH1yB7ZSo7stYH9a4cy4rwj85PiNPDnuxJhafOKBTaPthwDlkLb57Zgby9sweSLnliFLkLP6wz7tlEZhOcj8lCg9A42CH5m7wAsb7LeXrGPTOIWCQOBhorysGPji25gQxME7xJ2f7UZCG7BmFYnIiAqMsbhlAdgVjwW648znWPM+dqlMrxQArlGmVByS3bs8gT9uXNcfNHopuzjtF6QlZDs76LmIzH9r69Ot/uZt7DPnEFjtydPxNvH6GVg/wNN2oqIdoMOMVTFzMXcczf+a/cAsvyvcd0oSA5YU5WjhHw1oh/Yc9dsv+De4fwfJdc1FKwEPwD/E0c28HoJI8ehQ+aYQNrhEndzOOKIpgkK49Fu2HC0nt9023gY0ViWfTSMmTtTeKYlbcxhr7wbYwRVzuUw5M4Jbh+ac4ittSF6gqFki1WIjx5i3FrnDQEBtMwIQzVIc07R5zPl66SHl59kceNgag92bgC3mPuuPZ12vxt0+7HqC/HabDI5H2znYB+JOVb3Xya4oIMB+Pzy6h3LHkU01WPjKa9O1JADI9lWMRBcg=
    - secure: Nu8ORw70NVNAfYeFFPBc630OnU/bpjpk6o9e3aY+RPFLKF2F5JkROpFgVXr/EtMAI7a+TjRmJFKnE7xY2zTd5R3mWt+z+YAv0k7zk1fEdq74qg4hpM1oRueDba8cgr/W+b3IiEev3t8WEH05/UlJt14F1Pb/BjFgK5JfcGt+PFi9pz4eqKeCrbaeOONeBW6kTYsTDf1ljuS+uaV9Oj9K9SQdA1AaZK0v1q6WldKjWYWaZ6cBE8bzqfMrKgEzrN3yfyBpys1wnWiUeVk8zjcKXB3uYib97LIaBgg+aVk/mC4LNs/AszywtYZq3fkywhVY+p2TDIykohdqkibXOmBUwGCo63AXjQyP7aJIdiFco8gPmDNI7b2ce0Rc1zajxPUDQPU9OPwo80//7LK9b8DKL0NDthfjw+3IsqgN5rAVXzgP47RQLTXim1VWHxxcwqp3YdUYle93vZ1OQoAgG3ihJist+QsMHo+llqCliDzWx5va6CFFWX+Oknw9rC5xyTHBO4uq7CsE8Sb10KRDNWcs7OjvoSgmM8Nbnw1xKr/oYHITVgCT8F1IG+L+rppJT6EVwVny2LFNu1Rb+SNXonOAQQqEgyE12Eh/lTe33SZBpji0qal3UHHSrobE1cyt0VIHc5sqa0LySGZYokeDQRAPmSrLcj/WRu0YuyyZ+cUXNbY=

# PEP8 is mandatory
# matrix:
#   allow_failures:
#     - env: TOX_ENV=pep8

before_install:
  - npm install -g npm

install:
  - pip install tox coveralls

before_script:
  - npm install -g gulp
  - npm install -g codeclimate-test-reporter
  - npm install

after_script:
  - codeclimate < tests/coverage/**/lcov.info

script:
  - tox -e $TOX_ENV
  - gulp tests

after_success:
  - coveralls

notifications:
  webhooks: http://addons.us-iad-rs.aldryn.io/en/travis-endpoint/
